<div class="container">
	<div class="col-md-10 col-md-offset-1">
		<table class="table table-striped table-bordered table-hover" id="datatable-projects">
			<thead>
				<tr>
					<th>Client</th>
					<th>Project</th>
					<th>Description</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
				<% @projects.each do |project| %>
					<tr> 
						<td><p><%= project.client.name %></p></td>
						<td><h4><%= project.name %></h4></td>
						<td><p><%= project.description[0..128] + '...' %></p></td>
						<td><%= link_to "Project details", project_path(project.id), class: 'btn btn-danger btn-sm' %></td>
					</tr>
				<% end %>
			</tbody>
		</table>
	</div>		
</div>

<script>
  (function($) {
      $('#datatable-projects').DataTable({
          responsive: true,
          "order": [[ 0, 'desc' ]],
          "oLanguage": {
           "sEmptyTable": "Aún no hay participantes", //when empty
           "sSearch": "<span>Search:</span> _INPUT_", //search
           "sLengthMenu": "<span>Show _MENU_ projects</span>", //label
           "oPaginate": { "sFirst": "First", "sLast": "Last", "sNext": ">", "sPrevious": "<" }, //pagination
           "sInfo": "Displaying _START_ of _END_ upto _TOTAL_ projects"
          },
          "iDisplayLength": 6,
          "aLengthMenu": [[5, 10, 15, -1], [5, 10, 15, "All"]],
          "pagingType": "simple"
      });

      $('.used').mousedown(function() {
        var status = $(this).is(':checked');     
        var user_id = $(this).attr('id').split("-")[1];     
        var url = '/has_used_promo';
        var str = '{"user_id":"' + user_id + '","status":"' + status + '"}';
        var dataToSend = JSON.parse(str);
        var posting = $.post(url, dataToSend, function(data){
        });
        posting.done(function(data){
          // alert(data['message']);
        }) 
      });
  })(jQuery);
</script>