<div class="container">
	<div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
			<div class="panel-heading">
				<strong>Hi, <%= current_user.name.titleize %>. These are all our clients:</strong>
			</div>
			<div class="panel-body" style="padding-top:0px !important">
				<table class="table table-striped table-bordered table-hover" id="datatable-clients">
					<thead>
						<tr>
							<th>Client</th>
							<th>Contact</th>
							<th>Email</th>
							<th>Phone </th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						<% @clients.each do |client| %>
							<tr> 
								<td><p><%= client.name %></p></td>
								<td><h4><%= client.contact_name %></h4></td>
								<td><p><%= client.email %></p></td>
								<td><p><%= client.phone %></p></td>
								<td><%= link_to "Client´s details", client_path(client.id), class: 'btn btn-default btn-sm' %></td>
							</tr>
						<% end %>
					</tbody>
				</table>
			</div>
		</div>
	</div>		
</div>

<script>
  (function($) {
  	  console.log("EEEE");
      $('#datatable-clients').DataTable({
          responsive: true,
          "order": [[ 0, 'desc' ]],
          "oLanguage": {
           "sEmptyTable": "Aún no hay participantes", //when empty
           "sSearch": "<span>Search:</span> _INPUT_", //search
           "sLengthMenu": "<span>Show _MENU_ projects</span>", //label
           "oPaginate": { "sFirst": "First", "sLast": "Last", "sNext": ">", "sPrevious": "<" }, //pagination
           "sInfo": "Displaying _START_ of _END_ upto _TOTAL_ clients"
          },
          "iDisplayLength": 6,
          "aLengthMenu": [[5, 10, 15, -1], [5, 10, 15, "All"]],
          "pagingType": "simple"
      });

      $('.used').mousedown(function() {
        var status = $(this).is(':checked');     
        var user_id = $(this).attr('id').split("-")[1];     
        var url = '/has_used_promo';
        var str = '{"user_id":"' + user_id + '","status":"' + status + '"}';
        var dataToSend = JSON.parse(str);
        var posting = $.post(url, dataToSend, function(data){
        });
        posting.done(function(data){
          // alert(data['message']);
        }) 
      });
  })(jQuery);
</script>